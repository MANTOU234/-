"""
食品营养数据库模块
包含常见食物的重量、热量、蛋白质、脂肪和碳水化合物数据
所有数据均以100克为基准单位
"""

# 食品营养数据库
NUTRITION_DATA = {
    # 水果类
    "苹果": {"重量(g)": 100, "热量(kcal)": 52, "蛋白质(g)": 0.3, "脂肪(g)": 0.2, "碳水化合物(g)": 13.8},
    "香蕉": {"重量(g)": 100, "热量(kcal)": 89, "蛋白质(g)": 1.1, "脂肪(g)": 0.3, "碳水化合物(g)": 22.8},
    "橙子": {"重量(g)": 100, "热量(kcal)": 47, "蛋白质(g)": 0.9, "脂肪(g)": 0.1, "碳水化合物(g)": 11.8},
    "梨": {"重量(g)": 100, "热量(kcal)": 57, "蛋白质(g)": 0.4, "脂肪(g)": 0.1, "碳水化合物(g)": 15.2},
    "葡萄": {"重量(g)": 100, "热量(kcal)": 69, "蛋白质(g)": 0.7, "脂肪(g)": 0.2, "碳水化合物(g)": 18.1},
    "草莓": {"重量(g)": 100, "热量(kcal)": 32, "蛋白质(g)": 0.7, "脂肪(g)": 0.3, "碳水化合物(g)": 7.7},
    "西瓜": {"重量(g)": 100, "热量(kcal)": 30, "蛋白质(g)": 0.6, "脂肪(g)": 0.2, "碳水化合物(g)": 7.6},
    "猕猴桃": {"重量(g)": 100, "热量(kcal)": 61, "蛋白质(g)": 1.1, "脂肪(g)": 0.5, "碳水化合物(g)": 14.7},
    
    # 蔬菜类
    "西红柿": {"重量(g)": 100, "热量(kcal)": 18, "蛋白质(g)": 0.9, "脂肪(g)": 0.2, "碳水化合物(g)": 3.9},
    "黄瓜": {"重量(g)": 100, "热量(kcal)": 15, "蛋白质(g)": 0.7, "脂肪(g)": 0.1, "碳水化合物(g)": 3.6},
    "胡萝卜": {"重量(g)": 100, "热量(kcal)": 41, "蛋白质(g)": 0.9, "脂肪(g)": 0.2, "碳水化合物(g)": 9.6},
    "土豆": {"重量(g)": 100, "热量(kcal)": 77, "蛋白质(g)": 2.0, "脂肪(g)": 0.1, "碳水化合物(g)": 17.5},
    "白菜": {"重量(g)": 100, "热量(kcal)": 12, "蛋白质(g)": 1.2, "脂肪(g)": 0.2, "碳水化合物(g)": 2.2},
    "青椒": {"重量(g)": 100, "热量(kcal)": 20, "蛋白质(g)": 0.9, "脂肪(g)": 0.2, "碳水化合物(g)": 4.6},
    "茄子": {"重量(g)": 100, "热量(kcal)": 25, "蛋白质(g)": 1.0, "脂肪(g)": 0.2, "碳水化合物(g)": 5.7},
    "花菜": {"重量(g)": 100, "热量(kcal)": 25, "蛋白质(g)": 1.9, "脂肪(g)": 0.3, "碳水化合物(g)": 5.0},
    "菠菜": {"重量(g)": 100, "热量(kcal)": 23, "蛋白质(g)": 2.9, "脂肪(g)": 0.4, "碳水化合物(g)": 3.6},
    
    # 肉类
    "鸡胸肉": {"重量(g)": 100, "热量(kcal)": 165, "蛋白质(g)": 31.0, "脂肪(g)": 3.6, "碳水化合物(g)": 0.0},
    "猪肉瘦肉": {"重量(g)": 100, "热量(kcal)": 143, "蛋白质(g)": 20.0, "脂肪(g)": 7.0, "碳水化合物(g)": 0.0},
    "牛肉瘦肉": {"重量(g)": 100, "热量(kcal)": 250, "蛋白质(g)": 26.0, "脂肪(g)": 15.0, "碳水化合物(g)": 0.0},
    "羊肉": {"重量(g)": 100, "热量(kcal)": 294, "蛋白质(g)": 25.0, "脂肪(g)": 21.0, "碳水化合物(g)": 0.0},
    "鱼肉": {"重量(g)": 100, "热量(kcal)": 100, "蛋白质(g)": 20.0, "脂肪(g)": 2.0, "碳水化合物(g)": 0.0},
    "虾": {"重量(g)": 100, "热量(kcal)": 85, "蛋白质(g)": 18.0, "脂肪(g)": 1.0, "碳水化合物(g)": 0.0},
    
    # 主食类
    "米饭": {"重量(g)": 100, "热量(kcal)": 130, "蛋白质(g)": 2.6, "脂肪(g)": 0.3, "碳水化合物(g)": 28.0},
    "馒头": {"重量(g)": 100, "热量(kcal)": 223, "蛋白质(g)": 7.0, "脂肪(g)": 1.0, "碳水化合物(g)": 46.0},
    "面包": {"重量(g)": 100, "热量(kcal)": 265, "蛋白质(g)": 8.0, "脂肪(g)": 3.0, "碳水化合物(g)": 50.0},
    "面条": {"重量(g)": 100, "热量(kcal)": 138, "蛋白质(g)": 4.0, "脂肪(g)": 0.5, "碳水化合物(g)": 25.0},
    
    # 零食类
    "薯片": {"重量(g)": 100, "热量(kcal)": 536, "蛋白质(g)": 7.0, "脂肪(g)": 35.0, "碳水化合物(g)": 50.0},
    "巧克力": {"重量(g)": 100, "热量(kcal)": 545, "蛋白质(g)": 8.0, "脂肪(g)": 31.0, "碳水化合物(g)": 60.0},
    "饼干": {"重量(g)": 100, "热量(kcal)": 450, "蛋白质(g)": 6.0, "脂肪(g)": 18.0, "碳水化合物(g)": 70.0},
    "冰淇淋": {"重量(g)": 100, "热量(kcal)": 207, "蛋白质(g)": 3.5, "脂肪(g)": 11.0, "碳水化合物(g)": 24.0},
    
    # 饮料类
    "可乐": {"重量(g)": 100, "热量(kcal)": 42, "蛋白质(g)": 0.0, "脂肪(g)": 0.0, "碳水化合物(g)": 10.4},
    "牛奶": {"重量(g)": 100, "热量(kcal)": 60, "蛋白质(g)": 3.2, "脂肪(g)": 3.2, "碳水化合物(g)": 4.8},
    "橙汁": {"重量(g)": 100, "热量(kcal)": 45, "蛋白质(g)": 0.5, "脂肪(g)": 0.1, "碳水化合物(g)": 10.4},
    
    # 豆制品
    "豆腐": {"重量(g)": 100, "热量(kcal)": 76, "蛋白质(g)": 8.0, "脂肪(g)": 4.5, "碳水化合物(g)": 1.9},
    "豆浆": {"重量(g)": 100, "热量(kcal)": 33, "蛋白质(g)": 3.5, "脂肪(g)": 1.8, "碳水化合物(g)": 1.5},
    
    # 坚果类
    "花生": {"重量(g)": 100, "热量(kcal)": 567, "蛋白质(g)": 25.8, "脂肪(g)": 49.2, "碳水化合物(g)": 16.1},
    "核桃": {"重量(g)": 100, "热量(kcal)": 654, "蛋白质(g)": 15.2, "脂肪(g)": 65.2, "碳水化合物(g)": 13.7},
    "腰果": {"重量(g)": 100, "热量(kcal)": 553, "蛋白质(g)": 18.2, "脂肪(g)": 43.8, "碳水化合物(g)": 30.2},
    
    # 中餐常见菜品
    "米饭": {"重量(g)": 100, "热量(kcal)": 116, "蛋白质(g)": 2.6, "脂肪(g)": 0.3, "碳水化合物(g)": 25.6},
    "八宝粥": {"重量(g)": 100, "热量(kcal)": 85, "蛋白质(g)": 2.5, "脂肪(g)": 0.5, "碳水化合物(g)": 17.0},
    "白粥": {"重量(g)": 100, "热量(kcal)": 30, "蛋白质(g)": 1.0, "脂肪(g)": 0.1, "碳水化合物(g)": 6.0},
    "炒面": {"重量(g)": 100, "热量(kcal)": 180, "蛋白质(g)": 5.0, "脂肪(g)": 7.0, "碳水化合物(g)": 25.0},
    "葱油饼": {"重量(g)": 100, "热量(kcal)": 220, "蛋白质(g)": 4.0, "脂肪(g)": 10.0, "碳水化合物(g)": 30.0},
    "醋溜土豆丝": {"重量(g)": 100, "热量(kcal)": 90, "蛋白质(g)": 2.0, "脂肪(g)": 4.0, "碳水化合物(g)": 12.0},
    "地三鲜": {"重量(g)": 100, "热量(kcal)": 120, "蛋白质(g)": 3.0, "脂肪(g)": 6.0, "碳水化合物(g)": 15.0},
    "干煸豆角": {"重量(g)": 100, "热量(kcal)": 110, "蛋白质(g)": 4.0, "脂肪(g)": 5.0, "碳水化合物(g)": 12.0},
    "宫保鸡丁": {"重量(g)": 100, "热量(kcal)": 200, "蛋白质(g)": 15.0, "脂肪(g)": 10.0, "碳水化合物(g)": 10.0},
    "蚝油生菜": {"重量(g)": 100, "热量(kcal)": 50, "蛋白质(g)": 2.0, "脂肪(g)": 3.0, "碳水化合物(g)": 5.0},
    "红烧肉": {"重量(g)": 100, "热量(kcal)": 300, "蛋白质(g)": 12.0, "脂肪(g)": 25.0, "碳水化合物(g)": 5.0},
    "溜肉段": {"重量(g)": 100, "热量(kcal)": 250, "蛋白质(g)": 18.0, "脂肪(g)": 15.0, "碳水化合物(g)": 10.0},
    "平菇炒肉": {"重量(g)": 100, "热量(kcal)": 150, "蛋白质(g)": 10.0, "脂肪(g)": 8.0, "碳水化合物(g)": 8.0},
    "青菜炒面": {"重量(g)": 100, "热量(kcal)": 160, "蛋白质(g)": 5.0, "脂肪(g)": 6.0, "碳水化合物(g)": 22.0},
    "肉夹馍": {"重量(g)": 100, "热量(kcal)": 280, "蛋白质(g)": 12.0, "脂肪(g)": 12.0, "碳水化合物(g)": 30.0},
    "上汤菠菜": {"重量(g)": 100, "热量(kcal)": 60, "蛋白质(g)": 3.0, "脂肪(g)": 4.0, "碳水化合物(g)": 5.0},
    "什锦炒饭": {"重量(g)": 100, "热量(kcal)": 190, "蛋白质(g)": 6.0, "脂肪(g)": 7.0, "碳水化合物(g)": 25.0},
    "西红柿炒鸡蛋": {"重量(g)": 100, "热量(kcal)": 120, "蛋白质(g)": 8.0, "脂肪(g)": 7.0, "碳水化合物(g)": 5.0},
    "西兰花": {"重量(g)": 100, "热量(kcal)": 35, "蛋白质(g)": 3.0, "脂肪(g)": 0.5, "碳水化合物(g)": 5.0},
    "炸鸡腿": {"重量(g)": 100, "热量(kcal)": 350, "蛋白质(g)": 20.0, "脂肪(g)": 25.0, "碳水化合物(g)": 10.0}
}


def get_nutrition_info(food_name, count=1):
    """获取食物的营养信息，并根据数量进行调整
    
    Args:
        food_name: 食物名称
        count: 食物比例，基于100克计算，例如0.5表示50克，1表示100克，2表示200克
        
    Returns:
        包含营养信息的字典，如果找不到食物则返回None
    """
    if food_name in NUTRITION_DATA:
        data = NUTRITION_DATA[food_name].copy()
        
        # 打印调试信息
        print(f"计算 {food_name} 的营养成分 - 数据库基准: {data}")
        print(f"应用系数: {count}，相当于 {count*100} 克")
        
        # 确保数据字典中包含所有必要的键
        if "重量(g)" not in data:
            data["重量(g)"] = 100  # 默认100克
            
        # 确保键名一致
        key_mapping = {
            "热量": "热量(kcal)",
            "蛋白质": "蛋白质(g)",
            "脂肪": "脂肪(g)",
            "碳水化合物": "碳水化合物(g)"
        }
        
        # 统一键名
        for old_key, new_key in key_mapping.items():
            if old_key in data and new_key not in data:
                data[new_key] = data.pop(old_key)
        
        # 根据数量调整营养价值
        for key in data:
            if key != "重量(g)":  # 重量单位保持不变
                data[key] = round(data[key] * count, 1)
        
        # 更新实际重量
        data["重量(g)"] = round(data["重量(g)"] * count, 1)
        
        return data
    
    # 找不到食物名称时打印警告
    print(f"警告: 食物 '{food_name}' 不在营养数据库中")
    return None


def get_total_nutrition(food_counts):
    """计算多种食物的总营养成分
    
    Args:
        food_counts: 字典，键为食物名称，值为数量
        
    Returns:
        总营养成分字典
    """
    total = {"重量(g)": 0, "热量(kcal)": 0, "蛋白质(g)": 0, "脂肪(g)": 0, "碳水化合物(g)": 0}
    
    for food, count in food_counts.items():
        info = get_nutrition_info(food, count)
        if info:
            for key in total:
                total[key] += info[key]
    
    # 四舍五入到小数点后一位
    for key in total:
        total[key] = round(total[key], 1)
        
    return total 